# Insecure Data Storage Vulnerabilities

This directory contains educational demonstrations of insecure data storage vulnerabilities commonly found in mobile applications, aligned with OWASP MASVS-STORAGE requirements.

## ⚠️ ETHICAL USE DISCLAIMER

**These examples are for educational purposes only**. They demonstrate security vulnerabilities to help developers understand and prevent them. Do NOT use these techniques against applications you don't own or have explicit permission to test.

## Overview

Data storage vulnerabilities are among the most common security issues in mobile applications. They occur when sensitive data is stored insecurely on the device, making it accessible to attackers with physical access or other apps with sufficient privileges.

## Vulnerability Categories

### 1. Unencrypted Local Storage
- **Risk Level**: HIGH
- **MASVS Mapping**: MASVS-STORAGE-1
- **Description**: Sensitive data stored in plain text in local files or databases

### 2. Weak Encryption Implementation
- **Risk Level**: HIGH
- **MASVS Mapping**: MASVS-STORAGE-1, MASVS-CRYPTO-1
- **Description**: Using weak encryption algorithms or poor key management

### 3. Insecure Shared Storage
- **Risk Level**: MEDIUM
- **MASVS Mapping**: MASVS-STORAGE-2
- **Description**: Storing sensitive data in world-readable files or shared preferences

### 4. Inadequate Backup Protection
- **Risk Level**: MEDIUM
- **MASVS Mapping**: MASVS-STORAGE-8
- **Description**: Sensitive data included in application backups

## Educational Scenarios

### Scenario 1: Android Unencrypted SharedPreferences
**File**: `android_unencrypted_preferences_demo.py`
**Vulnerability**: Storing sensitive data in plain text SharedPreferences
**Learning Objective**: Understand how SharedPreferences can be accessed and demonstrate proper encryption

### Scenario 2: iOS Insecure Keychain Usage
**File**: `ios_insecure_keychain_demo.py`
**Vulnerability**: Using inappropriate keychain accessibility levels
**Learning Objective**: Learn proper keychain security levels and access controls

### Scenario 3: SQLite Database Security
**File**: `sqlite_database_security_demo.py`
**Vulnerability**: Unencrypted SQLite databases containing sensitive data
**Learning Objective**: Implement SQLite encryption and secure data handling

### Scenario 4: File System Security
**File**: `filesystem_security_demo.py`
**Vulnerability**: Storing sensitive files with improper permissions
**Learning Objective**: Understand file permissions and secure storage locations

## Testing Methodology

Each demonstration includes:
1. **Vulnerable Code Example**: Shows the insecure implementation
2. **Exploitation Technique**: How the vulnerability can be exploited
3. **Impact Assessment**: Business and security implications
4. **Secure Implementation**: The correct way to implement the feature
5. **Detection Methods**: How to identify this vulnerability during assessment

## Key Learning Points

### For Developers
- Always encrypt sensitive data before storage
- Use appropriate encryption algorithms and key management
- Understand platform-specific secure storage mechanisms
- Implement proper data classification and handling procedures

### For Security Assessors
- Know where different platforms store application data
- Understand various data extraction techniques
- Learn to identify weak encryption implementations
- Master tools for mobile data analysis

## Tools and Techniques

### Data Extraction Tools
- **Android**: ADB, SQLite browser, file system access
- **iOS**: iDevice tools, keychain dumper, file system access
- **Cross-platform**: Mobile forensics tools, hex editors

### Analysis Techniques
- Static file analysis
- Database examination
- Memory dump analysis
- Backup file investigation

## Remediation Guidelines

### Immediate Actions
1. Identify all sensitive data storage locations
2. Implement encryption for sensitive data
3. Use platform-recommended secure storage APIs
4. Review and update data retention policies

### Long-term Strategy
1. Implement data classification framework
2. Regular security code reviews
3. Automated security testing integration
4. Developer security training programs

## References

- [OWASP Mobile Security Testing Guide - Data Storage](https://owasp.org/www-project-mobile-security-testing-guide/)
- [Android Security Best Practices](https://developer.android.com/topic/security/best-practices)
- [iOS Security Guide](https://support.apple.com/guide/security/)
- [MASVS Storage Requirements](https://github.com/OWASP/owasp-masvs/blob/master/Document/0x07-V2-Data_Storage_and_Privacy_requirements.md)

## Safe Testing Environment

When practicing these techniques:
1. Use your own test applications
2. Test on dedicated devices or emulators
3. Never test on production applications without permission
4. Follow responsible disclosure practices
5. Respect privacy and legal boundaries

---
**Remember**: The goal is to learn how to build more secure applications, not to exploit existing ones maliciously.